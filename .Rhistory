# Plot the data with annotations
trend_plot <- new_cases_coronavirus %>%
ggplot(aes(date)) +
geom_segment(annotation_upper, mapping = aes(x = x, y = 0, xend = x, yend = 775), colour = "grey") +
geom_vline(vertical_lines, mapping = aes(xintercept = x), colour = "grey") +
geom_text_repel(data = annotation_upper, mapping = aes(x = x, y = 1000, label = label), size = 2.5) +
geom_line(aes(y = value, colour = parameter)) +
facet_wrap(~parameter, scales = "free_y", nrow = 2, labeller = plot_labels) +
labs(
title = "COVID-19 cases and coronavirus search trend in South Korea",
subtitle = str_c("Number of new COVID-19 cases per day and selected events (upper panel)",
"and\nsearch activity for 'coronavirus' in the portal NAVER relative to maximum (lower panel)."),
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
) +
xlab("Time (2020)") +
ylab("") +
theme(
legend.position = "none",
plot.subtitle = element_text(size = 9)
) +
scale_x_date(date_breaks = "2 weeks", date_labels = "%d-%b")
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/15_model_searchtrends.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/15_model_searchtrends.R', echo=TRUE)
install.packages(c("ggraph", "igraph", "tidygraph"))
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/16_model_transmission.R', echo=TRUE)
styler:::style_selection()
styler:::style_selection()
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/16_model_transmission.R', echo=TRUE)
styler:::style_selection()
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
?labs
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
tidyverse_conflicts()
# Clear workspace -------------------------------------------------------------
rm(list = ls())
# Load libraries --------------------------------------------------------------
library(tidyverse)
# Define functions ------------------------------------------------------------
source(file = "R/99_project_functions.R")
# Load all dataset files of the Korean COVID19 Dataset ------------------------
# Get file paths for database table files
dataset_files <- list.files(path = "_raw", full.names = TRUE)
# Load table files and set filename to snake case format
dataset_tables <- dataset_files %>%
setNames(nm = snake_case(.)) %>%
map(read_csv)
# Writing all tables to the data folder
dataset_tables %>%
names(.) %>%
map(~ write_tsv(pluck(dataset_tables, .), str_c("data/", ., "_data.tsv")))
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
install.packages(keras)
install.packages("keras")
source(file = "R/09_model_city_ann.R")
source(file = "R/10_model_most_visited.R")
source(file = "R/11_model_city_clustering.R")
source(file = "R/12_model_case_fatality_age.R")
source(file = "R/13_model_disease_progress.R")
source(file = "R/14_model_exposure.R")
source(file = "R/15_model_searchtrends.R")
source(file = "R/16_model_transmission.R")
source(file = "R/17_model_subset_transmission.R")
?detachAllPackages
detach("package:maptools", unload=TRUE)
styler:::style_selection()
detachAllPackages <- function() {
basic.packages <- c("package:stats","package:graphics","package:grDevices","package:utils","package:datasets","package:methods","package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:",search()))==1,TRUE,FALSE)]
package.list <- setdiff(package.list,basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package, character.only=TRUE)
}
detachAllPackages()
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
?gpclib
??gpclib
gpclibPermit()
library(maptools)
library(gpclib)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/01_load.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/01_load.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source(file = "R/09_model_city_ann.R")
source(file = "R/10_model_most_visited.R")
source(file = "R/11_model_city_clustering.R")
source(file = "R/12_model_case_fatality_age.R")
source(file = "R/13_model_disease_progress.R")
source(file = "R/14_model_exposure.R")
source(file = "R/15_model_searchtrends.R")
source(file = "R/16_model_transmission.R")
source(file = "R/17_model_subset_transmission.R")
# Clear Workspace ---------------------------------------------------------
rm(list = ls())
# Load libraries ----------------------------------------------------------
library("tidyverse")
library("tidygraph")
library("ggraph")
library("igraph")
# Load functions ----------------------------------------------------------
source(file = "R/99_project_functions.R")
# Load data ---------------------------------------------------------------
transmission_df <- read_tsv(file = "data/wrangled_transmission.tsv")
# Wrangle data ------------------------------------------------------------
# Find the persons who infect 10 or more others
filtered_transmission_df <- transmission_df %>%
group_by(from) %>%
filter(n() >= 10) %>%
ungroup()
# Create nodes
nodes <- filtered_transmission_df %>%
pivot_longer(
cols = c(to, from),
names_to = "status",
values_to = "patient_id"
) %>%
mutate(age_group = case_when(
status == "from" ~ age_group_infecting,
status == "to" ~ age_group_infected
)) %>%
select(patient_id, age_group) %>%
distinct()
# Visualise data ----------------------------------------------------------
# Create graph object
graph_obj <- graph_from_data_frame(filtered_transmission_df,
vertices = nodes, directed = TRUE
) %>%
as_tbl_graph()
# Create plot with nodes and arrows as edges
zoom_transmission_plot <- ggraph(graph_obj, layout = "fr") +
geom_edge_link(aes(colour = infection_case),
arrow = arrow(length = unit(1.5, "mm")),
start_cap = circle(1, "mm"),
end_cap = circle(1, "mm"),
edge_width = 0.4
) +
geom_node_point(aes(colour = age_group), size = 2) +
labs(
title = "Transmission plot for COVID-19 for patients who infect more than 10 individuals",
subtitle = "Patients are coloured by age group for patients and transmission events by route",
color = "Age group",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
) +
theme_graph(title_size = 16)
# Write plots and data to file --------------------------------------------
ggsave(
filename = "results/17_subset_transmission.png",
plot = zoom_transmission_plot,
width = 8,
height = 6
)
write_tsv(x = filtered_transmission_df, path = "data/wrangled_transmission_filtered.tsv")
# Detach external packages ---------------------------------------------------------------------
detach("package:igraph", unload=TRUE)
detach("package:tidygraph", unload=TRUE)
detach("package:ggraph", unload=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
# Create plot with nodes and arrows as edges
zoom_transmission_plot <- ggraph(graph_obj, layout = "fr") +
geom_edge_link(aes(colour = infection_case),
arrow = arrow(length = unit(1.5, "mm")),
start_cap = circle(1, "mm"),
end_cap = circle(1, "mm"),
edge_width = 0.4
) +
geom_node_point(aes(colour = age_group), size = 2) +
labs(
title = "Transmission plot for COVID-19 for patients who infect more than 10 individuals",
subtitle = "Patients are coloured by age group for patients and transmission events by route",
color = "Age group",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
) +
theme_graph(title_size = 16)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/17_model_subset_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source(file = "R/03_augment.R")
source(file = "R/08_model_city_pca.R")
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/08_model_city_pca.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/08_model_city_pca.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/08_model_city_pca.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/08_model_city_pca.R', echo=TRUE)
source(file = "R/08_model_city_pca.R")
git status¨
git status
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
library(shiny); runApp('R/04_shiny_app.R')
runApp('R/04_shiny_app.R')
runApp('R/04_shiny_app.R')
runApp('R/04_shiny_app.R')
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
View(case_df)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(length(type)), inherit.aes = TRUE,) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(length(type)), inherit.aes = TRUE) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(length(type))) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
type_n <- patient_df %>% length(type)
type_n <- patient_df %>% length(type)
View(patient_df)
type_n <- patient_df %>%
distinct(type) %>%
n()
patient_df %>%
distinct(type) %>%
n()
patient_df %>%
distinct(type)
patient_df %>%
distinct(type) %>%
length()
patient_df %>%
distinct(type) %>%
n()
patient_df %>%
distinct(type) %>%
count()
patient_df %>%
distinct(type) %>%
sum(count())
patient_df %>%
distinct(type)
patient_df %>%
distinct(type) %>%
length()
patient_df %>%
distinct(type) %>%
length()
patient_df %>%
length(type)
patient_df %>%
distinct(type) %>%
length()
patient_df %>%
select(type) %>%
length()
patient_df %>%
distinct(type) %>%
length(type)
patient_df %>%
distinct(type) %>%
length()
patient_df %>%
distinct(type) %>%
tally()
patient_df %>%
tally(type)
patient_df %>%
tally()
patient_df %>%
length(unique(type))
patient_df %>%
n_distinct(type)
patient_df %>%
n_distinct(type)
View(patient_df)
patient_df %>%
n_distinct(type, na.rm = TRUE)
patient_df %>%
select(type) %>%
n_distinct()
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(n_distinct(select(type)))) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(n_types)) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
n_types <- patient_df %>%
select(type) %>%
n_distinct()
mvp_plot <- patient_df %>%
ggplot(aes(x = type)) +
geom_bar(fill = heat.colors(n_types)) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
View(patient_df)
mvp_plot <- patient_df %>%
ggplot(aes(x = type, y = count)) +
geom_bar(fill = heat.colors(n_types)) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
mvp_plot <- patient_df %>%
ggplot(aes(x = type, y = count)) +
geom_bar(fill = heat.colors(n_types)) +
coord_flip() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
mvp_plot <- patient_df %>%
ggplot(aes(x = type, y = count)) +
geom_bar(fill = heat.colors(n_types)) +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
View(mvp_plot)
View(patient_df)
View(mvp_plot)
View(patient_df)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
mvp_plot <- patient_df %>%
ggplot() +
geom_bar(aes(x = type, y = count, fill = heat.colors(n_types))) +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
View(patient_df)
mvp_plot <- patient_df %>%
ggplot(aes(x = count, y = type)) +
geom_bar() +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
mvp_plot <- patient_df %>%
ggplot(aes(x = reorder(type, count), y = count, fill = case_type)) +
geom_bar(stat = "identity") +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
mvp_plot <- patient_df %>%
ggplot(aes(x = reorder(type, count), y = count, fill = type)) +
geom_bar(stat = "identity") +
labs(
title = "Most visited places",
y = "Number of patients",
x = "Place",
caption = "Data from Korea Centers for Disease Control & Prevention (2020)"
)
mvp_plot
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
mvp_plot
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/10_model_most_visited.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/05_model_case_type.R', echo=TRUE)
styler:::style_selection()
styler:::style_selection()
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/03_augment.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/16_model_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/16_model_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/16_model_transmission.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
dependencies(
path = getwd(),
root = NULL,
...,
progress = TRUE,
errors = c("reported", "fatal", "ignored"),
dev = FALSE
)
install.packages(renv)
install.packages("renv")
library("renv")
dependencies(
path = getwd(),
root = NULL,
...,
progress = TRUE,
errors = c("reported", "fatal", "ignored"),
dev = FALSE
)
dependencies(
path = getwd(),
root = NULL,
...,
progress = TRUE,
)
dependencies("./R")
write_csv(dependencies("./R"), path=./)
write_csv(dependencies("./R"), path="./")
write_csv(dependencies("./R"), path="results")
write_csv(dependencies("./R"), path="/dependencies.csv")
write_csv(dependencies("./R"), path="dependencies.csv")
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/07_model_patient_route.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
install.packages("igraph")
install.packages("igraph")
git status
install.packages('rsconnect')
rsconnect::setAccountInfo(name='erik-kiehl',
token='B5D685A24266BE5FA44596DD671EFBD8',
secret='j7FXnRDeR5g4aC09ctUystjTqS0LfVQqudgrPD83')
library(rsconnect)
rsconnect::deployApp('R/04_shiny_app.R')
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/00_doit.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/13_model_disease_progress.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/13_model_disease_progress.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
install.packages("leaflet")
library(shiny); runApp('R/04_shiny_app.R')
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
source('~/Desktop/R for bio data scientists/Project/2020_group10/R/09_model_city_ann.R', echo=TRUE)
runApp('~/Desktop/R for bio data scientists/Project/shiny_app/04_shiny_app.R')
