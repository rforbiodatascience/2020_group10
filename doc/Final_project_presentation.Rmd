---
title: <font size="10"> Revealing the success behind South Korea's approach to COVID-19 </font>
subtitle: "22100 - R for Bio Data Science"
author: "Abril Diosdado Hernandez, Amanda Gammelby Qvesel, Erik Nicolas Kiehl, Viktor Törnblom"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  ioslides_presentation:
    widescreen: true
    smaller: true
   
---
```{r setup, include=FALSE}
library(knitr)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
```
## **Introduction**

### *South Korea during COVID-19*
South Korea is one of the world's most densely populated countries with 51.64 million people.

The first case of COVID-19 in this country was confirmed on the 20th of January 2020. Since then, there has only been 256 deaths caused by COVID-19.


## Research questions
* How has the epidemic evolved in South Korea?

* Is there any correlation between the place of infection and severity of the disease?

* Does any gender or age predispose for getting the disease or for a more severe outcome?

* Are there any characteristic features in the high-prevalence disease areas?

* Can a prediction of the disease confirmation be made based on the city?


## Materials and methods
```{r out.width = "60%", fig.align='center',fig.cap= "COVID-19 dataset from kaggle" }
include_graphics('dataset.png')
```

## Workflow and Structure of the project
```{r, fig.width = 1}
include_graphics('project_structure.png')
include_graphics('images/workflow.png')
```


***
### Packages used
Project core:

- [Tidyverse](https://github.com/tidyverse/tidyverse)

Transmission:

- [igraph](https://github.com/igraph/igraph)

Map: 

- [viridis](https://github.com/sjmgarnier/viridis)    
- [maptools](https://github.com/RPTools/maptool)
- [gpclib](https://github.com/rdpeng/gpclib)
- [rgdal](https://github.com/cran/rgdal/tree/master/inst)
- [plotly](https://github.com/plotly)  

 Shiny app
- [geosphere](https://github.com/rspatial/geosphere)
- [shiny](https://github.com/rstudio/shiny)
- [leaflet](http://rstudio.github.io/leaflet)



***

### Data cleaning & augmenting
- Get rid of unnecessary data
- Remove non valid data
- Converting data into a tidy format

* filter(), mutate ()

- Join tibbles
- Create new variables
- Transform
- Subset the data

* full_join(), mutate(), unite ()

***
Four main data frames were created regarding:

<div class="green">
- patient (patient_info_df + patient_route_df)
</div>
<div class="red">
- case
</div>
<div class="yellow">
- city
</div>
<div class="blue">
- time (time_df, time_age_df, time_province_df)
</div>
<div class="grey">
- serchtrend
</div>

SeoulFloating and Weather were not used

Problem: our data set repeats the same name for come columns.

Solution: added a prefix


## Results

```{r out.width = "50%", fig.show = "hold"}
include_graphics(c('../results/10_most_visited_places.png', '../results/05_model_case_type.png'))

```

***
```{r out.width = "65%", fig.align = "center"}
include_graphics('../results/13_disease_progress.png')
```

***
```{r out.width = "75%", fig.align = "center"}
include_graphics('../results/13_logistic_model.png')
```
***
```{r out.width = "100%", fig.align = "center"}
include_graphics('../results/15_searchtrend.png')
```

***
```{r out.width = "75%", fig.align = "center"}
include_graphics('../results/07_cases_number.png')
```

***
```{r out.width = "70%", fig.align = "center"}
include_graphics('../results/13_disease_age.png')
```

***
```{r out.width = "50%"}
include_graphics(c('../results/13_confirmed_gender.png', '../results/13_deceased_gender.png'))
```

***
using nest()
```{r out.width = "55%", fig.align = "center"}
include_graphics('../results/12_age_deceased_ratio.png')
```


***
```{r out.width = "80%", fig.align = "center"}
include_graphics('../results/14_contact_exposure.png')
```


***
```{r out.width = "90%", fig.align = "center"}
include_graphics('../results/16_transmission.png')
```

***
```{r out.width = "55%", fig.align = "center"}
include_graphics('../results/08_model_pca.png')
```

***
```{r out.width = "55%", fig.align = "center"}
include_graphics('../results/08_model_pca_variance.png')
```

***
```{r out.width = "90%", fig.align = "center", message=FALSE}
include_graphics('../results/11_city_clustering.png')
cluster_pred <- read_tsv("../data/wrangled_cluster_pred.tsv") %>% 
  head()
knitr::kable(cluster_pred, format="html")
```

## ANN 
```{r}
ann_pred <- read_tsv("../data/wrangled_ann_pred") %>% 
  head()
knitr::kable(ann_pred, format="html")
```






## Shiny app

https://erik-kiehl.shinyapps.io/shiny_app/

## Conclusion and discussion 
* Confirmed cases is high compared to deaths. 

* One peak (until beginning of April), follows logistic model

* There’s no correlation between the place of infection and severity of the disease

* Men die but more women are confirmed to be sick. Young people are driving the spread.

* At least from the retrieved data, there is no strong difference.

* People in their 70s and 80s have a higher fatality rage (as expected).

***
* There are clusters of superspreaders and certain age range can be observed in each. 

* A higher disease prevalence can be observed in bigger cities and those who have nursing homes, which is very different from what can be seen in the countryside, where elderly population ratio and elderly alone present less cases. 

* Accuracy is just above 50 % - better than random with 4 classes.

* Similar performance as kmeans. 

Problems and solutions

Using different packages will mask some functions.
 
 - detach packages after each R cript.
 

***
### Superspreaders
```{r out.width = "70%", fig.align = "center"}
include_graphics('../results/17_subset_transmission.png')
```

***
### Correlation matrix
```{r out.width = "70%", fig.align = "center"}
include_graphics('../results/06_model_cor.png')
```
